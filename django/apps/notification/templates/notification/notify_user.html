{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static "admin/css/changelists.css" %}">
  {% if cl.formset %}
    <link rel="stylesheet" href="{% static "admin/css/forms.css" %}">
  {% endif %}
  {% if cl.formset or action_form %}
    <script src="{% url 'admin:jsi18n' %}"></script>
  {% endif %}
  {{ media.css }}
  {% if not actions_on_top and not actions_on_bottom %}
    <style>
      #changelist table thead th:first-child {width: inherit}
    </style>
  {% endif %}
{% endblock %}

{% block extrahead %}
{{ block.super }}
{{ media.js }}
<script src="{% static 'admin/js/filters.js' %}" defer></script>
{% endblock %}

{% block bodyclass %}{{ block.super }} app-{{ opts.app_label }} model-{{ opts.model_name }} change-list{% endblock %}

{% block coltype %}{% endblock %}

{% block content %}
  <div id="content-main">
    <div class="module{% if cl.has_filters %} filtered{% endif %}" id="changelist">
      <div class="changelist-form-container">

        <form id="changelist-form" method="post" novalidate>
            {% csrf_token %}

            <div class="results">
                <table id="result_list">
                    <thead>
                        <th scope="col" class="action-checkbox-column" style="width: 3%;">
                            <div class="text">
                                <span>
                                    <input 
                                        type="checkbox" 
                                        id="action-toggle" 
                                        aria-label="Select all objects on this page for an action"
                                    >
                                </span>
                            </div>
                        </th>
                        <th>
                            {% trans 'First Name' %}
                        </th>
                        <th>
                            {% trans 'Last Name' %}
                        </th>
                        <th>
                            {% trans 'Email' %}
                        </th>
                    </thead>
                    <tbody>
                        {% for result in object.saved_filter.get_queryset %}
                            <tr>
                                <td class="action-checkbox">
                                    <input type="checkbox" name="users" value="{{ result.pk }}" class="action-select" aria-label="Select this object for an action - admin: Can manage company profile">
                                </td>
                                <td>
                                    {{ result.user.first_name }}
                                </td>
                                <td>
                                    {{ result.user.last_name }}
                                </td>
                                <td>
                                    {{ result.user.email }}
                                </td>
                            </tr>
                        {% empty %}
                            <tr>
                                <td colspan="4" style="text-align: center;">
                                    {% trans 'No template has been created yet.' %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="submit-row" style="margin-top: 1rem;">
                <input type="submit" class="default" value="Notify">
            </div>
        </form>
      </div>
    </div>
</div>
<script>
    document.getElementById('action-toggle').addEventListener('click', function() {
        var checkboxes = document.querySelectorAll('.action-select');
        for (var i = 0; i < checkboxes.length; i++) {
            checkboxes[i].checked = this.checked;
        }
    });
</script>
{% endblock %}
